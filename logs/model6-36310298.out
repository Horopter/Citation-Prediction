Activating virtual environment: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/Kaggle_2/venv
==========================================
JOB STARTUP INFORMATION
==========================================
Host:        gl1016.arc-ts.umich.edu
Date:        2025-11-19T02:09:40-05:00
SLURM_JOBID: 36310298
Working directory: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/Kaggle_2
Python:      /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/Kaggle_2/venv/bin/python
==========================================
Verifying Python environment...
‚úì Basic packages available
‚úì Python environment verified
Installing Jupyter kernel: model6-36310298...
Installed kernelspec model6-36310298 in /home/santoshd/.local/share/jupyter/kernels/model6-36310298
‚úì Kernel installed successfully
Running pre-flight validation...
‚úì Found model-ready files
‚úì Notebook found: src/notebooks/model6_lightgbm_all_features.ipynb
‚úÖ Pre-flight validation passed!
=== Cleaning Previous Runs ===
‚úì Cleanup completed
Running papermill -> /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/Kaggle_2/runs/model6_executed_20251119-021021.ipynb
Notebook: src/notebooks/model6_lightgbm_all_features.ipynb
Kernel: model6-36310298
Input Notebook:  src/notebooks/model6_lightgbm_all_features.ipynb
Output Notebook: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/Kaggle_2/runs/model6_executed_20251119-021021.ipynb
Executing notebook with kernel: model6-36310298
Executing Cell 1---------------------------------------
Ending Cell 1------------------------------------------
Executing Cell 2---------------------------------------
Ending Cell 2------------------------------------------
Executing Cell 3---------------------------------------
Using device: cuda
PROJECT_ROOT: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/Kaggle_2
MODEL_READY_DIR: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/Kaggle_2/data/model_ready

‚úÖ Using sklearn IncrementalPCA (memory-efficient)
‚úÖ Memory utilities imported
PROJECT_ROOT: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/Kaggle_2
üíæ Memory: 0.60 GB (RAM) | 0.00/0.00 GB (GPU used/reserved)

Ending Cell 3------------------------------------------
Executing Cell 4---------------------------------------
Ending Cell 4------------------------------------------
Executing Cell 5---------------------------------------
Loading train from /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/Kaggle_2/data/model_ready/train_model_ready.parquet

Loading val from /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/Kaggle_2/data/model_ready/val_model_ready.parquet


üìä Data Summary:
  Regular features: 54
  Embedding sent_transformer_: 384 dims
  Embedding scibert_: 768 dims
  Embedding specter2_: 768 dims
  Train samples: 960000, Positive: 65808, Negative: 894192
  Val samples: 120000, Positive: 8075, Negative: 111925

üíæ Memory: 32.75 GB (RAM) | 0.00/0.00 GB (GPU used/reserved)

Ending Cell 5------------------------------------------
Executing Cell 6---------------------------------------
Ending Cell 6------------------------------------------
Executing Cell 7---------------------------------------

üìä Applying IncrementalPCA to embedding families...
  sent_transformer_: 384 dims ‚Üí 32 components
  scibert_: 768 dims ‚Üí 32 components
  specter2_: 768 dims ‚Üí 32 components

  Fitting PCA on subset (50000/960000 samples) for sent_transformer_

  Fitting PCA on subset (50000/960000 samples) for scibert_

  Fitting PCA on subset (50000/960000 samples) for specter2_


üìä After IncrementalPCA:
  Train embeddings: (960000, 96)
  Val embeddings: (120000, 96)

  Combined train: (960000, 150)
  Combined val: (120000, 150)

üíæ Memory: 34.06 GB (RAM) | 0.00/0.00 GB (GPU used/reserved)

Ending Cell 7------------------------------------------
Executing Cell 8---------------------------------------

üìä Using RobustScaler (robust to outliers)
  Fitting scaler on chunks (size=50000) for OOM protection...
‚ùå Error in scaling: 'RobustScaler' object has no attribute 'partial_fit'
‚ö†Ô∏è Continuing without scaling...

Ending Cell 8------------------------------------------
Executing Cell 9---------------------------------------
Ending Cell 9------------------------------------------
Executing Cell 10--------------------------------------

üìä Full dataset for CV: (1080000, 150), labels: (1080000,)
  Positive samples: 73883, Negative: 1006117

üîç Hyperparameter tuning:
  Method: RandomizedSearchCV
  CV folds: 5
  Random iterations: 50

üíæ Memory: 35.27 GB (RAM) | 0.00/0.00 GB (GPU used/reserved)

Ending Cell 10-----------------------------------------
Executing Cell 11--------------------------------------

================================================================================
Starting Hyperparameter Tuning
================================================================================
Fitting 5 folds for each of 50 candidates, totalling 250 fits

Removed /home/santoshd/.local/share/jupyter/kernels/model6-36310298
